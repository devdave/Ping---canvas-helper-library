<!DOCTYPE html>
<html>
    <head>
        <title>Mapping/partitioning</title>
        <script src="/js/jquery.js"></script>
        <!--<script type="text/javascript" src="/js/jquery.jstree.js"></script>-->
        <script src="libs/app.core.js"></script>
        <script src="libs/app.main.js"></script>
        <script src="libs/app.shapes.js"></script>
        <script src="libs/app.canvas.js"></script>
        <script src="/quadtree.js"></script>
        <script src="/quadtree.util.js"></script>
    </head>
    <body>
        
        <canvas height="400" width="600" id="mapper"></canvas>
        <div class="statPanel" style="float:right">
            <ol id="wtf"></ol><br/>
            <label>Node list</label>
            <ul id="nodeList"></ul>
        </div>
        <script>
            
            function run(){
                
                
                var balls = [];
                for(var bMax = 0; bMax < 6; bMax++){
                    balls.push(ballFactory(600,400));                 
                }
                
                var stepPos = 3;
                ctx = appLib.$C("mapper");
                map = QuadrantFactory(ctx, stepPos);
                
                function runLogic(){
                    var highX = 0, highY = 0;
                    ctx = appLib.$C("mapper");
                    delete map;
                    map = QuadrantFactory(ctx, stepPos);
                    for(var i = 0; i < balls.length; i++){
                        balls[i] = RunBall(balls[i], map);
                        highX = Math.max(highX, Math.abs(balls[i].dx));
                        highY = Math.max(highY, Math.abs(balls[i].dy));
                    }
                    ctx.beginPath();
                    ctx.clearAll();
                    for(var i = 0; i < balls.length; i++){
                        balls[i] = RenderBall(balls[i], map, ctx)
                    }
                    map.render(ctx);
                    ctx.closePath();                    
                }
                setInterval(runLogic, 25);
               
               
            };
        
            $(run);
        </script>
        
    </body>
</html>